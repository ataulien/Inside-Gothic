


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.2.2">
    
    
      
        <title>Daily Routine - Inside-Gothic</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.a2408e81.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.a46bcfb3.min.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#daily-routines" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href=".." title="Inside-Gothic" class="md-header-nav__button md-logo" aria-label="Inside-Gothic">
      
  <img src="../images/gothic_custom_icon_by_thedoctor45_d3hszn0-250t.png" alt="logo">

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            Inside-Gothic
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Daily Routine
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Inside-Gothic" class="md-nav__button md-logo" aria-label="Inside-Gothic">
      
  <img src="../images/gothic_custom_icon_by_thedoctor45_d3hszn0-250t.png" alt="logo">

    </a>
    Inside-Gothic
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Objects
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M8.59 16.58L13.17 12 8.59 7.41 10 6l6 6-6 6-1.41-1.42z"/></svg>
      </span>
    </label>
    <nav class="md-nav" aria-label="Objects" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
        </span>
        Objects
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../objects/objects-overview/" title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects/vob/" title="Vob" class="md-nav__link">
      Vob
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects/mob/" title="Interactive (Mob)" class="md-nav__link">
      Interactive (Mob)
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects/spot/" title="Spot" class="md-nav__link">
      Spot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects/npc/" title="Npc" class="md-nav__link">
      Npc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../objects/item/" title="Item" class="md-nav__link">
      Item
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../ActionQueue/" title="Action Queue" class="md-nav__link">
      Action Queue
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../Rain/" title="Rain" class="md-nav__link">
      Rain
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Daily Routine
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Daily Routine" class="md-nav__link md-nav__link--active">
      Daily Routine
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#waypoints-as-rough-location-markers" class="md-nav__link">
    Waypoints as rough location markers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#script-states" class="md-nav__link">
    Script States
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interruptions" class="md-nav__link">
    Interruptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weird-daily-routines" class="md-nav__link">
    Weird Daily Routines
  </a>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../monster-ai/" title="Monster AI" class="md-nav__link">
      Monster AI
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../fight-ai/" title="Fight AI" class="md-nav__link">
      Fight AI
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../DialogueSystem/" title="Dialogue System" class="md-nav__link">
      Dialogue System
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../QuestLog/" title="Quest Log" class="md-nav__link">
      Quest Log
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#waypoints-as-rough-location-markers" class="md-nav__link">
    Waypoints as rough location markers
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#script-states" class="md-nav__link">
    Script States
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interruptions" class="md-nav__link">
    Interruptions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#weird-daily-routines" class="md-nav__link">
    Weird Daily Routines
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                  
                
                
                <h1 id="daily-routines">Daily Routines</h1>
<p>As discussed in the <a href="#npc">NPC class overview</a>, the Daily Routine is executed if
an NPC has nothing else to do. They are defined via Daedalus-scripts. For
example, this is <a href="https://github.com/GothicII/GOTHIC-MOD-Development-Kit/blob/4071a70b3a8943e374ccbf886986e494b4be0858/gothic/_work/data/Scripts/content/Story/NPC/PC_Thief.d#L50">Diegos Daily
Routine</a>
after you talked to him at the start of the game (<code>TA</code> meaning <code>Tages Ablauf</code>,
just <code>Daily Routine</code> in German):</p>
<div class="highlight"><pre><span></span><code><span class="n">FUNC</span> <span class="n">VOID</span> <span class="nf">Rtn_Start_1</span> <span class="p">()</span>
<span class="p">{</span>
  <span class="c1">//              Start   End</span>
  <span class="n">TA_Sleep</span>       <span class="p">(</span><span class="mi">23</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mo">03</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_HUT_1&quot;</span><span class="p">);</span>
  <span class="n">TA_SitAround</span>   <span class="p">(</span><span class="mo">03</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mo">05</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span>  <span class="s">&quot;OCR_HUT_Z5_SIT3&quot;</span><span class="p">);</span>
  <span class="n">TA_Sleep</span>       <span class="p">(</span><span class="mo">05</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span>  <span class="mo">07</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAULDRON_1&quot;</span><span class="p">);</span>
  <span class="n">TA_SitAround</span>   <span class="p">(</span><span class="mo">07</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mi">10</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAULDRON_1&quot;</span><span class="p">);</span>
  <span class="n">TA_Smalltalk</span>   <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mi">12</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAMPFIRE_A_MOVEMENT1&quot;</span><span class="p">);</span> <span class="c1">//mit Grim</span>
  <span class="n">TA_SitAround</span>   <span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mi">16</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAULDRON_1&quot;</span><span class="p">);</span>
  <span class="n">TA_Smalltalk</span>   <span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mi">18</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAMPFIRE_A_MOVEMENT3&quot;</span><span class="p">);</span> <span class="c1">//mit Stt_322</span>
  <span class="n">TA_SitCampfire</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mi">23</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAMPFIRE_A_MOVEMENT1&quot;</span><span class="p">);</span>
<span class="p">};</span>
</code></pre></div>

<p>Script functions like the one above are executed once when the NPC is spawned or
has changed its Daily Routine. Each of the function calls registers its activity
in the Todo-list each Npc has for the specified timespan and Waypoint, which
specifies the location on where that activity should be done.</p>
<blockquote>
<p>Internally, each of those <code>TA_something</code>-functions maps to only one script
external, <code>TA_Min</code>. A complete list of all possible actions is defined
<a href="github.com/GothicII/GOTHIC-MOD-Development-Kit/blob/4071a70b3a8943e374ccbf886986e494b4be0858/gothic/_work/data/Scripts/content/Story/ZS/Ta.d">here</a>.</p>
</blockquote>
<h2 id="waypoints-as-rough-location-markers">Waypoints as rough location markers</h2>
<p>As you can see in the code snipped above, there is an interesting comment, <code>// mit Grim</code>:</p>
<div class="highlight"><pre><span></span><code><span class="n">TA_Smalltalk</span><span class="p">(...,</span> <span class="s">&quot;OCR_CAMPFIRE_A_MOVEMENT1&quot;</span><span class="p">)</span> <span class="c1">// mit Grim</span>
</code></pre></div>

<p>This says, that Diego should to Smalltalk with the Npc <em>Grim</em>. However, that is
just a code comment. The <code>TA_Smalltalk</code> activity just searches for <em>any</em> nearby
Npc to do smalltalk with. In Grims Daily Routine, there is a similar entry,
which makes them both go to the same location to meet there every day. Both of
them just don't know who to expect there and meet every day by "chance", which
is kinda funny.</p>
<p>This also applies to states where interactive items are involved. They usually
just say <em>Go to some location and see if you can find an Amboss to work on</em>. If
that is already occupied, the Npc may do something else instead.</p>
<h2 id="script-states">Script States</h2>
<p>This is a complex topic, which I need to quickly go over for daily routines.
However, Script States are also used for other purposes extensively.</p>
<p>Each of the Daily-Routine actions registered for that Npc executes a <em>Script
State</em> on that Npc when its time has come. For example, lets look at this line
again:</p>
<div class="highlight"><pre><span></span><code>  <span class="n">TA_Smalltalk</span>   <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="mi">12</span><span class="p">,</span><span class="mo">00</span><span class="p">,</span>  <span class="s">&quot;OCR_CAMPFIRE_A_MOVEMENT1&quot;</span><span class="p">);</span> <span class="c1">//mit Grim</span>
</code></pre></div>

<p>On execution, this registers the Script State <code>ZS_SMALLTALK</code> from 10:00 to 12:00
at the location <code>OCR_CAMPFIRE_A_MOVEMENT1</code> in Diegos Daily Routine.
<code>ZS_SMALLTALK</code> is then defined
<a href="https://github.com/GothicII/GOTHIC-MOD-Development-Kit/blob/4071a70b3a8943e374ccbf886986e494b4be0858/gothic/_work/data/Scripts/content/Story/ZS/ZS_Smalltalk.d">here</a>.</p>
<p>Each Script State can have the following script functionality:</p>
<ol>
<li>An <code>init</code> function, called once when the state is started</li>
<li>A <code>loop</code> function, called every frame while the state is active and there is
   nothing else to do. This function can also decide whether the state should
   continue.</li>
<li>An <code>end</code> function, called when the state has ended.</li>
</ol>
<p>If the time goes on and a different Daily Routine action gets activated, the
current state is canceled gracefully and the next state is started.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>For <code>ZS_SMALLTALK</code>, you can break that down in the following (as seen from the
Npcs perspecitve):</p>
<p><strong>Begin the state:</strong></p>
<ol>
<li>Set me to slow-walkmode.</li>
<li>If I am not already on a Freepoint called <code>SMALLTALK</code>, let me go to the
    Waypoint registered in the Daily Routine.</li>
<li>Then, let me go to the next unoccupied Freepoint called <code>SMALLTALK</code>.</li>
<li>Face into the direction of the Freepoint.</li>
</ol>
<p><strong>Then, when there is nothing else to do:</strong></p>
<p><img alt="" src="../images/script-state-smalltalk.svg" /></p>
<p>On this particular Script-State, there is not action when the state ended.</p>
</div>
<h2 id="interruptions">Interruptions</h2>
<p>Execution of the Script State belonging to the current Daily Routine action is
interrupted by assigning any other Script State to the Npc, ie. when when taking
damage or talking to the Npc, which starts <code>ZS_TALK</code>.</p>
<p>Once the non-routine Script State is over and the Npc has nothing to do anymore,
the Daily Routine is started again.</p>
<h2 id="weird-daily-routines">Weird Daily Routines</h2>
<p>There are some gameplay elements you wouldn't think of as a Daily Routine, such as</p>
<ul>
<li>Following the Player</li>
<li>Guiding the player to some location</li>
</ul>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../Rain/" title="Rain" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Rain
              </div>
            </div>
          </a>
        
        
          <a href="../monster-ai/" title="Monster AI" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Monster AI
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.d710d30a.min.js"></script>
      <script src="../assets/javascripts/bundle.5f27aba8.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.27c6a5e6.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>